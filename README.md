## vue-cli-ssr

基于vue 2.6、vue-cli、koa.js构建的ssr应用模板。

主要目的是为了摆脱nuxt.js的束缚，在基于vue-cli构建项目的基础上平滑过渡到ssr。

vue 2.6中新增的serverPrefetch、$ssrContext、__INITIAL_STATE__ api，对ssr支持更为友好。尽管构建过程依然繁琐，配套资源也不够完善，但是已经降低了使用门槛，使用官方接口也更为规范。

### 为什么不是nuxt.js

nuxt.js为ssr提供了很多开箱即用的特性，扁平化的目录结构、可扩展的插件、模块机制，对于定制化需求要求不高的项目是不错的选择。

但是，由于nuxt中会产生多无意义的实例开销，集成的很多功能并非所需，同时增加了额外的学习和配置成本。如果对ssr本身并不了解，那么也很难对nuxt进行深入的理解、优化和扩展。

比如nuxt.js基于目录结构自动生成路由的机制看似美好，在路由规则相对简单的场景下表现很不错，但是一旦遇到复杂的路由场景，两种路由机制同时存在，整个路由规则就会变的非常混乱且难以维护。

另外，目录导航的特性中包含隐性链接变更行为，这种变更往往不易被察觉，目录名或目录结构的变更会导致大量的已有链接变成死链接，对搜索引擎而言很不友好。相对而言基于代码声明的常规路由规则要更加直观、稳定和严谨的多。

### 使用方法

1. 启动api服务器

```
npm run api
```

2. 启动vue ssr服务器

```
npm run serve
```

### src/入口说明

#### 纯客户端入口

```
src/main.js
```

#### build:client客户端入口

```
src/entry.client.js
```

#### build:server服务端入口

```
src/entry.server.js
```